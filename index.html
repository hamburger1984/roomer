<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Roomer - Grundriss Planer</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="manifest" href="manifest.json" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  </head>
  <body>
    <div id="app">
      <header role="banner">
        <h1>Roomer - Grundriss Planer</h1>
        <div class="header-controls">
          <div
            id="snapshotGraphHeader"
            class="snapshot-graph-header"
            role="navigation"
            aria-label="Snapshot Navigation"
          ></div>
          <button
            id="createSnapshot"
            class="btn-icon"
            aria-label="Snapshot erstellen"
          >
            üì∏
          </button>
          <span
            id="projectNameDisplay"
            class="project-name-display"
            aria-live="polite"
            >Unbenanntes Projekt</span
          >
          <button
            id="renameProject"
            class="btn-icon"
            aria-label="Projekt umbenennen"
          >
            ‚úèÔ∏è
          </button>
          <button
            id="exportProject"
            class="btn-icon"
            aria-label="Projekt exportieren"
          >
            üíæ
          </button>
          <button
            id="importProject"
            class="btn-icon"
            aria-label="Projekt importieren"
          >
            üìÇ
          </button>
          <input
            type="file"
            id="projectImport"
            accept=".json,.roomer.json"
            class="panel-hidden"
            aria-label="Projekt-Datei ausw√§hlen"
          />
          <button id="closeProject" class="btn" aria-label="Projekt schlie√üen">
            Projekt schlie√üen
          </button>
        </div>
      </header>

      <div class="container">
        <!-- Sidebar Hover Trigger -->
        <div class="sidebar-hover-trigger"></div>

        <!-- Sidebar Pin Button -->
        <button
          class="sidebar-pin-btn"
          id="sidebarPinBtn"
          aria-label="Sidebar anheften"
          aria-pressed="false"
        >
          üìå
        </button>

        <!-- Sidebar -->
        <aside
          class="sidebar"
          id="sidebar"
          role="complementary"
          aria-label="M√∂bel und Werkzeuge"
        >
          <section class="section" aria-labelledby="furniture-section-heading">
            <h2 id="furniture-section-heading" class="sr-only">
              M√∂belkategorien
            </h2>
            <nav class="furniture-categories" aria-label="M√∂belkategorien">
              <button
                class="category-btn active"
                data-category="all"
                aria-pressed="true"
              >
                Alle
              </button>
              <button
                class="category-btn"
                data-category="seating"
                aria-pressed="false"
              >
                Sitzgelegenheiten
              </button>
              <button
                class="category-btn"
                data-category="tables"
                aria-pressed="false"
              >
                Tische
              </button>
              <button
                class="category-btn"
                data-category="storage"
                aria-pressed="false"
              >
                Schr√§nke
              </button>
              <button
                class="category-btn"
                data-category="beds"
                aria-pressed="false"
              >
                Betten
              </button>
              <button
                class="category-btn"
                data-category="appliances"
                aria-pressed="false"
              >
                Ger√§te
              </button>
              <button
                class="category-btn"
                data-category="decoration"
                aria-pressed="false"
              >
                Dekoration
              </button>
            </nav>
            <div id="furnitureList" class="furniture-list" role="list"></div>
          </section>

          <section
            class="section panel-hidden"
            id="selectedFurniturePanel"
            aria-labelledby="furniture-properties-heading"
          >
            <h2 id="furniture-properties-heading" class="sr-only">
              M√∂beleigenschaften
            </h2>
            <form
              class="furniture-properties"
              aria-label="M√∂beleigenschaften bearbeiten"
            >
              <label>
                Name:
                <input type="text" id="furnitureName" aria-label="M√∂belname" />
              </label>
              <label>
                Breite (cm):
                <input
                  type="number"
                  id="furnitureWidth"
                  step="1"
                  min="1"
                  aria-label="Breite in Zentimetern"
                />
              </label>
              <label>
                Tiefe (cm):
                <input
                  type="number"
                  id="furnitureDepth"
                  step="1"
                  min="1"
                  aria-label="Tiefe in Zentimetern"
                />
              </label>
              <label id="seatDepthLabel" class="property-label-hidden">
                Sitzfl√§che (cm):
                <input
                  type="number"
                  id="furnitureSeatDepth"
                  step="1"
                  min="1"
                  aria-label="Sitzfl√§chentiefe in Zentimetern"
                />
              </label>
              <label id="expandedWidthLabel" class="property-label-hidden">
                Breite ausgeklappt (cm):
                <input
                  type="number"
                  id="furnitureExpandedWidth"
                  step="1"
                  min="1"
                  aria-label="Breite ausgeklappt in Zentimetern"
                />
              </label>
              <label id="expandedDepthLabel" class="property-label-hidden">
                Tiefe ausgeklappt (cm):
                <input
                  type="number"
                  id="furnitureExpandedDepth"
                  step="1"
                  min="1"
                  aria-label="Tiefe ausgeklappt in Zentimetern"
                />
              </label>
              <label>
                Rotation (¬∞):
                <input
                  type="number"
                  id="furnitureRotation"
                  step="1"
                  min="0"
                  max="359"
                  aria-label="Rotation in Grad"
                />
              </label>
              <button
                id="deleteFurniture"
                class="btn btn-danger"
                type="button"
                aria-label="M√∂bel l√∂schen"
              >
                L√∂schen
              </button>
            </form>
          </section>
        </aside>

        <!-- Main Canvas Area -->
        <main
          class="canvas-container"
          role="main"
          aria-label="Grundriss-Arbeitsbereich"
        >
          <div id="canvasWrapper" class="canvas-wrapper">
            <canvas id="mainCanvas" aria-label="Grundriss-Canvas"></canvas>
            <div
              id="uploadOverlay"
              class="upload-overlay"
              role="dialog"
              aria-labelledby="upload-dialog-title"
            >
              <div class="upload-box">
                <h2 id="upload-dialog-title">Neues Projekt</h2>
                <p>Grundriss hochladen</p>
                <input
                  type="file"
                  id="floorPlanUpload"
                  accept="image/*,.pdf"
                  class="panel-hidden"
                  aria-label="Grundriss-Datei ausw√§hlen"
                />
                <input
                  type="text"
                  id="projectNameInput"
                  placeholder="Projektname"
                  class="project-name-input"
                  aria-label="Projektname eingeben"
                />
                <button
                  id="uploadBtn"
                  class="btn upload-btn-sized"
                  aria-label="Datei f√ºr Grundriss ausw√§hlen"
                >
                  üìÅ Datei ausw√§hlen
                </button>

                <section
                  class="project-list-section"
                  aria-labelledby="saved-projects-heading"
                >
                  <h3 id="saved-projects-heading">Gespeicherte Projekte</h3>
                  <div
                    id="projectList"
                    class="project-list-container"
                    role="list"
                  ></div>
                </section>
              </div>
            </div>

            <!-- Bottom Right Toolbar -->
            <nav class="canvas-controls" aria-label="Ansichtssteuerung">
              <button
                id="undoBtn"
                class="btn-icon"
                aria-label="R√ºckg√§ngig"
                disabled
              >
                ‚Ü∂
              </button>
              <button
                id="redoBtn"
                class="btn-icon"
                aria-label="Wiederherstellen"
                disabled
              >
                ‚Ü∑
              </button>
              <span class="scale-separator" aria-hidden="true">|</span>
              <button id="zoomIn" class="btn-icon" aria-label="Hineinzoomen">
                +
              </button>
              <button id="zoomOut" class="btn-icon" aria-label="Herauszoomen">
                -
              </button>
              <button
                id="resetView"
                class="btn-icon"
                aria-label="Ansicht zur√ºcksetzen"
              >
                ‚åÇ
              </button>
              <span id="zoomLevel" aria-live="polite" aria-label="Zoomstufe"
                >100%</span
              >
              <span class="scale-separator" aria-hidden="true">|</span>
              <span id="scaleDisplay" class="scale-info" aria-live="polite"
                >Kein Ma√üstab</span
              >
              <button
                id="calibrateBtnSmall"
                class="btn-icon"
                aria-label="Ma√üstab kalibrieren"
              >
                ‚úèÔ∏è
              </button>
              <button
                id="cropBtn"
                class="btn-icon"
                aria-label="Grundriss zuschneiden"
              >
                ‚úÇÔ∏è
              </button>
            </nav>

            <!-- Calibration Panel -->
            <aside
              id="calibrationPanel"
              class="calibration-panel panel-hidden"
              role="dialog"
              aria-labelledby="calibration-panel-title"
            >
              <h4 id="calibration-panel-title">Ma√üstab kalibrieren</h4>
              <p class="calibration-instructions">
                1. Klicken Sie auf Startpunkt<br />
                2. Klicken Sie auf Endpunkt<br />
                3. Geben Sie die echte L√§nge ein
              </p>
              <div id="calibrationMeasure" class="panel-hidden">
                <label>
                  L√§nge dieser Linie:
                  <input
                    type="number"
                    id="calibrationLength"
                    step="0.01"
                    min="0.01"
                    placeholder="z.B. 3.25"
                    aria-label="L√§nge der Referenzlinie"
                  />
                  <select id="calibrationUnit" aria-label="Ma√üeinheit">
                    <option value="m">Meter</option>
                    <option value="cm">Zentimeter</option>
                  </select>
                </label>
                <div class="calibration-controls">
                  <button
                    id="applyCalibrationBtn"
                    class="btn"
                    aria-label="Kalibrierung √ºbernehmen"
                  >
                    √úbernehmen
                  </button>
                  <button
                    id="cancelCalibrationBtn"
                    class="btn btn-secondary"
                    aria-label="Kalibrierung abbrechen"
                  >
                    Abbrechen
                  </button>
                </div>
              </div>
            </aside>

            <!-- Crop Panel -->
            <aside
              id="cropPanel"
              class="crop-panel panel-hidden"
              role="dialog"
              aria-labelledby="crop-panel-title"
            >
              <h4 id="crop-panel-title">Grundriss zuschneiden</h4>
              <p class="crop-instructions">
                Ziehen Sie ein Rechteck √ºber den gew√ºnschten Bereich
              </p>
              <div id="cropControls" class="panel-hidden">
                <p>
                  Ausgew√§hlter Bereich:
                  <span id="cropDimensions"></span>
                </p>
                <div class="crop-controls">
                  <button
                    id="applyCropBtn"
                    class="btn"
                    aria-label="Zuschneiden anwenden"
                  >
                    Zuschneiden
                  </button>
                  <button
                    id="cancelCropBtn"
                    class="btn btn-secondary"
                    aria-label="Zuschneiden abbrechen"
                  >
                    Abbrechen
                  </button>
                </div>
              </div>
            </aside>
          </div>
        </main>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
      // Register service worker
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("sw.js")
          .then((reg) => console.log("Service Worker registered"))
          .catch((err) => console.log("Service Worker registration failed"));
      }
    </script>
  </body>
</html>
